From MIT 6.828.
